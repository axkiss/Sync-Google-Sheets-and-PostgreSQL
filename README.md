# Sync-Google-Sheets-and-PostgreSQL

Скрипт для синхронизации таблицы из Google Sheets с таблицей в базе данных PostgreSQL

### Пример данных в Google Sheets

№| заказ № | стоимость,$ |срок поставки
------ |---------|-------------| ------
1   | 2167    | 234         | 13.05.2022
2   | 2564    | 346         | 14.05.2022
3   | 2678    | 78          | 13.06.2022
4   | 6776    | 890         | 19.05.2022

При изменении кол-ва колонок требуется внести изменения в каждый запрос к базе данных в файле services/db.py и изменить число колонок NUMS_COLUMNS
## Инструкция

* Установить requirements.txt
* Создать пользователя и базу данных в PostgreSQL
* Создать сервисный аккаунт в Google Cloud и получить ключ credentials.json (https://habr.com/ru/post/488756/#avtorizaciya-cherez-servisnyy-akkaunt)
* Добавить почту сервисного аккаунта в свою таблицу Google Sheets
* Заполнить файл settings.py полученными данными.

Запуск возможен в трех режимах:
1. `python script.py`
2. `python script.py deep`
3. `python script.py show`

### Режим №1:
Данные из Google Sheets документа обновляются полностью при любом изменение документа, то есть таблица в базе данных будет очищаться и заполняться заново.

### Режим №2:
Продуманный режим глубокого анализа содержимого Google Sheets документа на изменение. Данные привязываются к столбцу(№) с номером строки.

Для корректной работы данные в столбце "№" должны быть уникальные и числами.

Строки без номера или номера отличные от чисел будут игнорироваться. 
При дублировании будет оставлена строка с таким же номером, которая уже занесена в базу данных.

Недостающие данные заполняются значением NULL

### Режим №3:
Просто красивый вывод таблицы из базы данных в консоль :)


## Requirements
- Python 3.10
- Google Sheets API v4